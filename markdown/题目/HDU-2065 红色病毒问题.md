# [HDU-2065 "红色病毒"问题](../page/page1.html)

题目链接:[http://acm.hdu.edu.cn/showproblem.php?pid=2065](http://acm.hdu.edu.cn/showproblem.php?pid=2065)

## 题目大意
有`A`,`B`,`C`,`D`四种字符,其中字符`A`,`C`只能出现偶数次,其他字符没有要求.给出一个$N$要求按照上述规则构造一个字符串,求方案数$\pmod{100}$,其中$1 \leq N \leq 2^{64}$.

## 解析
使用指数型生成函数:

从题目不难看出:
$$
\begin{aligned}
    &\hat{A}(x)=\hat{C}(x)=1+\dfrac{1}{2!}x^{2}+\dfrac{1}{4!}x^{4}\dots \\
    &\hat{B}(x)=\hat{D}(x)=1+x+\dfrac{1}{2!}x^{2}\dots \\
\end{aligned}
$$
所以总体的生成函数为:
$$
\begin{aligned}
    \hat{G}(x)
    &=\hat{A}(x)\times\hat{B}(x)\times\hat{C}(x)\times\hat{D}(x) \\
    &=(1+\dfrac{1}{2!}x^{2}+\dfrac{1}{4!}x^{4}\dots)^{2}\times(1+x+\dfrac{1}{2!}x^{2}\dots)^{2}
\end{aligned}
$$
根据泰勒展开:
$$
\begin{aligned}
    e^{x}&=1+x+\dfrac{1}{2!}x^{2}\dots \\
    e^{-x}&=1-x+\dfrac{1}{2!}x^{2}\dots
\end{aligned}
$$
所以:
$$
\begin{aligned}
    \hat{G}(x)
    &=(\dfrac{e^{x}+e^{-x}}{2})^{2}\times(e^{x})^{2} \\
    &=\dfrac{e^{4x}+2e^{2x}+1}{4}
\end{aligned}
$$
又因为:
$$
\begin{aligned}
    e^{2x}&=1+2x+\dfrac{2^{2}}{2!}x^{2}\dots \\
    e^{4x}&=1+4x+\dfrac{4^{2}}{2!}x^{2}\dotsb
\end{aligned}
$$
所以答案就是$x^{n}$的系数乘以$n!$,即$2^{n-1}+4^{n-1} \pmod{100}$

最后,只需要打一个快速幂就可以解决这道题了.

> 2023年09月08日 / 题解 / FFT